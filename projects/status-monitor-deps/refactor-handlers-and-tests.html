
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Defining handlers Â· Practicalli Clojure WebApps</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Practicalli">
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-callouts/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-folding-chapters/folding-chapters.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-newtabs/bootstrap.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-newtabs/tabs.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism.css">
                
            
                
                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-sectionx/sectionx.css">
                
            
                
                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-simpletabs/tabs.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-terminull-light/terminull.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-toggle-chapters/toggle.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-wide-page/wide.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="continuous-integration.html" />
    
    
    <link rel="prev" href="unit-test-mocking-handlers.html" />
    

    </head>
    <body>
        


<div class="book">
    <div class="book-summary">
        
      <!-- <div class="theme-code-header">
           <a href="" class="link">
           <h1 class="title">Practicalli Clojure WebApps</h1>
           </a>
           </div> -->
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://practicalli.github.io" target="_blank" class="custom-link">Practical.li</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                  <!--  -->
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../requirements.html">
            
                <a href="../../requirements.html">
            
                  <!--  -->
                    Requirements
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../clojure-web-services-overview.html">
            
                <a href="../../clojure-web-services-overview.html">
            
                  <!--  -->
                    Overview
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Clojure CLI Projects</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="./">
            
                <a href="./">
            
                  <!--  -->
                    Status Monitor
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="application-server.html">
            
                <a href="application-server.html">
            
                  <!--  -->
                    Application server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="debugging-requests.html">
            
                <a href="debugging-requests.html">
            
                  <!--  -->
                    Debug requests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="unit-test-mocking-handlers.html">
            
                <a href="unit-test-mocking-handlers.html">
            
                  <!--  -->
                    Unit Test & Mocking
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.1.4" data-path="refactor-handlers-and-tests.html">
            
                <a href="refactor-handlers-and-tests.html">
            
                  <!--  -->
                    Defining handlers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="continuous-integration.html">
            
                <a href="continuous-integration.html">
            
                  <!--  -->
                    Continuous integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.6" data-path="deployment-via-ci.html">
            
                <a href="deployment-via-ci.html">
            
                  <!--  -->
                    Deployment via CI
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../banking-on-clojure/">
            
                <a href="../banking-on-clojure/">
            
                  <!--  -->
                    Banking on Clojure
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../banking-on-clojure/application-server-configuration.html">
            
                <a href="../banking-on-clojure/application-server-configuration.html">
            
                  <!--  -->
                    App Server Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="../banking-on-clojure/refactor-handler.html">
            
                <a href="../banking-on-clojure/refactor-handler.html">
            
                  <!--  -->
                    Refactor handlers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.3" data-path="../banking-on-clojure/defining-handlers.html">
            
                <a href="../banking-on-clojure/defining-handlers.html">
            
                  <!--  -->
                    Defining handlers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.4" data-path="../banking-on-clojure/continuous-integration.html">
            
                <a href="../banking-on-clojure/continuous-integration.html">
            
                  <!--  -->
                    Continuous Integration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.5" data-path="../banking-on-clojure/deployment-pipeline.html">
            
                <a href="../banking-on-clojure/deployment-pipeline.html">
            
                  <!--  -->
                    Deployment Pipeline
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.6" data-path="../banking-on-clojure/deployment-via-ci.html">
            
                <a href="../banking-on-clojure/deployment-via-ci.html">
            
                  <!--  -->
                    Deployment via CI to Heroku
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.7" data-path="../banking-on-clojure/unit-tests.html">
            
                <a href="../banking-on-clojure/unit-tests.html">
            
                  <!--  -->
                    Unit Tests
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.8" data-path="../banking-on-clojure/spec-generative-testing.html">
            
                <a href="../banking-on-clojure/spec-generative-testing.html">
            
                  <!--  -->
                    Clojure Specs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.9" data-path="../banking-on-clojure/development-database.html">
            
                <a href="../banking-on-clojure/development-database.html">
            
                  <!--  -->
                    Development database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.10" data-path="../banking-on-clojure/instrument-next-jdbc-functions.html">
            
                <a href="../banking-on-clojure/instrument-next-jdbc-functions.html">
            
                  <!--  -->
                    Instrument next.jdbc functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.11" data-path="../banking-on-clojure/database-tables.html">
            
                <a href="../banking-on-clojure/database-tables.html">
            
                  <!--  -->
                    Database tables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.12" data-path="../banking-on-clojure/database-queries.html">
            
                <a href="../banking-on-clojure/database-queries.html">
            
                  <!--  -->
                    Database queries
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.12.1" data-path="../banking-on-clojure/create-records.html">
            
                <a href="../banking-on-clojure/create-records.html">
            
                  <!--  -->
                    Create Records
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.12.2" data-path="../banking-on-clojure/read-records.html">
            
                <a href="../banking-on-clojure/read-records.html">
            
                  <!--  -->
                    Read Records
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.12.3" data-path="../banking-on-clojure/update-records.html">
            
                <a href="../banking-on-clojure/update-records.html">
            
                  <!--  -->
                    Update Records
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.12.4" data-path="../banking-on-clojure/delete-records.html">
            
                <a href="../banking-on-clojure/delete-records.html">
            
                  <!--  -->
                    Delete Records
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2.13" data-path="../banking-on-clojure/cyclic-load-dependency.html">
            
                <a href="../banking-on-clojure/cyclic-load-dependency.html">
            
                  <!--  -->
                    Cyclic Load Dependency
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.14" data-path="../banking-on-clojure/clojure-spec-generate-mock-data.html">
            
                <a href="../banking-on-clojure/clojure-spec-generate-mock-data.html">
            
                  <!--  -->
                    Spec: generate database data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.15" data-path="../banking-on-clojure/unit-testing-the-database.html">
            
                <a href="../banking-on-clojure/unit-testing-the-database.html">
            
                  <!--  -->
                    Unit Testing Database
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.16" data-path="../banking-on-clojure/honeysql.html">
            
                <a href="../banking-on-clojure/honeysql.html">
            
                  <!--  -->
                    HoneySQL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.17" data-path="../banking-on-clojure/namespace-design.html">
            
                <a href="../banking-on-clojure/namespace-design.html">
            
                  <!--  -->
                    Namespace design
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.18" data-path="../banking-on-clojure/production-database.html">
            
                <a href="../banking-on-clojure/production-database.html">
            
                  <!--  -->
                    Production database
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">REPL Driven Development</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../../repl-driven-development/">
            
                <a href="../../repl-driven-development/">
            
                  <!--  -->
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../../repl-driven-development/integrant-repl/">
            
                <a href="../../repl-driven-development/integrant-repl/">
            
                  <!--  -->
                    integrant REPL
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Libraries</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../../libraries/reitit/">
            
                <a href="../../libraries/reitit/">
            
                  <!--  -->
                    Reitit
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../../libraries/reitit/constructing-routes.html">
            
                <a href="../../libraries/reitit/constructing-routes.html">
            
                  <!--  -->
                    Routing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Architectural Components</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../../app-servers/">
            
                <a href="../../app-servers/">
            
                  <!--  -->
                    Application servers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../../app-servers/clojure-project.html">
            
                <a href="../../app-servers/clojure-project.html">
            
                  <!--  -->
                    Clojure project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="../../app-servers/create-server.html">
            
                <a href="../../app-servers/create-server.html">
            
                  <!--  -->
                    Create server
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.2.1" data-path="../../app-servers/jetty-server-options.html">
            
                <a href="../../app-servers/jetty-server-options.html">
            
                  <!--  -->
                    Jetty server options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2.2" data-path="../../app-servers/http-kit-server-options.html">
            
                <a href="../../app-servers/http-kit-server-options.html">
            
                  <!--  -->
                    Httpkit server options
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.1.3" data-path="../../app-servers/start-server.html">
            
                <a href="../../app-servers/start-server.html">
            
                  <!--  -->
                    Start Server
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.3.1" data-path="../../app-servers/java-system-properties.html">
            
                <a href="../../app-servers/java-system-properties.html">
            
                  <!--  -->
                    Java Properties
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.1.4" data-path="../../app-servers/simple-restart.html">
            
                <a href="../../app-servers/simple-restart.html">
            
                  <!--  -->
                    Simple restart
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.5" data-path="../../app-servers/atom-based-restart.html">
            
                <a href="../../app-servers/atom-based-restart.html">
            
                  <!--  -->
                    Atom based restart
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.6" data-path="../../app-servers/app-server-logging.html">
            
                <a href="../../app-servers/app-server-logging.html">
            
                  <!--  -->
                    Logging
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../../application-logic/">
            
                <a href="../../application-logic/">
            
                  <!--  -->
                    Application logic
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../../application-logic/routing.html">
            
                <a href="../../application-logic/routing.html">
            
                  <!--  -->
                    Routing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../../relational-databases-and-sql/">
            
                <a href="../../relational-databases-and-sql/">
            
                  <!--  -->
                    Relational Database & SQL
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="../../relational-databases-and-sql/next-jdbc-library/">
            
                <a href="../../relational-databases-and-sql/next-jdbc-library/">
            
                  <!--  -->
                    next.jdbc library
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1.1" data-path="../../relational-databases-and-sql/next-jdbc-library/connection-pool-lifecycle.html">
            
                <a href="../../relational-databases-and-sql/next-jdbc-library/connection-pool-lifecycle.html">
            
                  <!--  -->
                    Component lifecycle
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.1.2" data-path="../../relational-databases-and-sql/h2-database/">
            
                <a href="../../relational-databases-and-sql/h2-database/">
            
                  <!--  -->
                    H2 Database
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.2.1" data-path="../../relational-databases-and-sql/h2-database/schema-design.html">
            
                <a href="../../relational-databases-and-sql/h2-database/schema-design.html">
            
                  <!--  -->
                    H2 schema design
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.2.2" data-path="../../relational-databases-and-sql/h2-database/database-tools.html">
            
                <a href="../../relational-databases-and-sql/h2-database/database-tools.html">
            
                  <!--  -->
                    H2 database tools
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.1.3" data-path="../../relational-databases-and-sql/postgresql-database.html">
            
                <a href="../../relational-databases-and-sql/postgresql-database.html">
            
                  <!--  -->
                    PostgreSQL Database
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.3.1" data-path="../../relational-databases-and-sql/managing-connections.html">
            
                <a href="../../relational-databases-and-sql/managing-connections.html">
            
                  <!--  -->
                    Managing Connections
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Leiningen Projects</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../leiningen/todo-app/">
            
                <a href="../leiningen/todo-app/">
            
                  <!--  -->
                    TODO WebApp
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1" data-path="../leiningen/todo-app/create-a-project/">
            
                <a href="../leiningen/todo-app/create-a-project/">
            
                  <!--  -->
                    Create a Project
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1.1" data-path="../leiningen/todo-app/create-a-project/update-project-details.html">
            
                <a href="../leiningen/todo-app/create-a-project/update-project-details.html">
            
                  <!--  -->
                    Update Project details
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.2" data-path="../leiningen/todo-app/create-a-webserver-with-ring/">
            
                <a href="../leiningen/todo-app/create-a-webserver-with-ring/">
            
                  <!--  -->
                    Create a webserver with Ring
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.2.1" data-path="../leiningen/todo-app/create-a-webserver-with-ring/add-ring-dependency.html">
            
                <a href="../leiningen/todo-app/create-a-webserver-with-ring/add-ring-dependency.html">
            
                  <!--  -->
                    Add Ring Dependency
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2.2" data-path="../leiningen/todo-app/create-a-webserver-with-ring/configure-main-namespace.html">
            
                <a href="../leiningen/todo-app/create-a-webserver-with-ring/configure-main-namespace.html">
            
                  <!--  -->
                    Configure main namespace
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2.3" data-path="../leiningen/todo-app/create-a-webserver-with-ring/namespaces.html">
            
                <a href="../leiningen/todo-app/create-a-webserver-with-ring/namespaces.html">
            
                  <!--  -->
                    Theory: namespaces
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2.4" data-path="../leiningen/todo-app/create-a-webserver-with-ring/include-ring-library.html">
            
                <a href="../leiningen/todo-app/create-a-webserver-with-ring/include-ring-library.html">
            
                  <!--  -->
                    Include Ring Library
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2.5" data-path="../leiningen/todo-app/create-a-webserver-with-ring/add-a-jetty-webserver.html">
            
                <a href="../leiningen/todo-app/create-a-webserver-with-ring/add-a-jetty-webserver.html">
            
                  <!--  -->
                    Add a Jetty webserver
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2.6" data-path="../leiningen/todo-app/create-a-webserver-with-ring/coersing-types-and-java-lang.html">
            
                <a href="../leiningen/todo-app/create-a-webserver-with-ring/coersing-types-and-java-lang.html">
            
                  <!--  -->
                    Theory: Coercing Types & java.lang
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2.7" data-path="../leiningen/todo-app/create-a-webserver-with-ring/run-webserver.html">
            
                <a href="../leiningen/todo-app/create-a-webserver-with-ring/run-webserver.html">
            
                  <!--  -->
                    Run webserver
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.3" data-path="../leiningen/todo-app/introducing-ring/">
            
                <a href="../leiningen/todo-app/introducing-ring/">
            
                  <!--  -->
                    Theory: Introducing Ring
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.4" data-path="../leiningen/todo-app/create-a-handler-function/">
            
                <a href="../leiningen/todo-app/create-a-handler-function/">
            
                  <!--  -->
                    Create a handler function
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.4.1" data-path="../leiningen/todo-app/create-a-handler-function/add-not-found.html">
            
                <a href="../leiningen/todo-app/create-a-handler-function/add-not-found.html">
            
                  <!--  -->
                    Add error for bad routes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.4.2" data-path="../leiningen/todo-app/create-a-handler-function/if-function.html">
            
                <a href="../leiningen/todo-app/create-a-handler-function/if-function.html">
            
                  <!--  -->
                    Theory: if function
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.4.3" data-path="../leiningen/todo-app/create-a-handler-function/maps-and-keywords.html">
            
                <a href="../leiningen/todo-app/create-a-handler-function/maps-and-keywords.html">
            
                  <!--  -->
                    Theory: maps and keywords
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.5" data-path="../leiningen/todo-app/unit-test-handler-function/">
            
                <a href="../leiningen/todo-app/unit-test-handler-function/">
            
                  <!--  -->
                    Unit test handler function
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.6" data-path="../leiningen/todo-app/reloading-the-application/">
            
                <a href="../leiningen/todo-app/reloading-the-application/">
            
                  <!--  -->
                    Reloading the application
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.6.1" data-path="../leiningen/todo-app/reloading-the-application/test-your-code-reloads.html">
            
                <a href="../leiningen/todo-app/reloading-the-application/test-your-code-reloads.html">
            
                  <!--  -->
                    Test your code reloads
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.6.2" data-path="../leiningen/todo-app/reloading-the-application/middleware.html">
            
                <a href="../leiningen/todo-app/reloading-the-application/middleware.html">
            
                  <!--  -->
                    Middleware in Ring
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.7" data-path="../leiningen/todo-app/compojure/">
            
                <a href="../leiningen/todo-app/compojure/">
            
                  <!--  -->
                    Compojure
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.7.1" data-path="../leiningen/todo-app/compojure/theory-routing.html">
            
                <a href="../leiningen/todo-app/compojure/theory-routing.html">
            
                  <!--  -->
                    Theory: routing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.7.2" data-path="../leiningen/todo-app/compojure/adding-dependency.html">
            
                <a href="../leiningen/todo-app/compojure/adding-dependency.html">
            
                  <!--  -->
                    Adding dependency
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.7.3" data-path="../leiningen/todo-app/compojure/using-compojure.html">
            
                <a href="../leiningen/todo-app/compojure/using-compojure.html">
            
                  <!--  -->
                    Using Compojure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.7.4" data-path="../leiningen/todo-app/compojure/adding-goodbye-route.html">
            
                <a href="../leiningen/todo-app/compojure/adding-goodbye-route.html">
            
                  <!--  -->
                    Adding goodbye route
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.7.5" data-path="../leiningen/todo-app/compojure/about.html">
            
                <a href="../leiningen/todo-app/compojure/about.html">
            
                  <!--  -->
                    About route
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.7.6" data-path="../leiningen/todo-app/compojure/show-request-info.html">
            
                <a href="../leiningen/todo-app/compojure/show-request-info.html">
            
                  <!--  -->
                    Show request info
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.7.7" data-path="../leiningen/todo-app/compojure/variable-path-elements.html">
            
                <a href="../leiningen/todo-app/compojure/variable-path-elements.html">
            
                  <!--  -->
                    Variable Path Elements
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.7.8" data-path="../leiningen/todo-app/compojure/theory-local-name-bindings.html">
            
                <a href="../leiningen/todo-app/compojure/theory-local-name-bindings.html">
            
                  <!--  -->
                    Theory: local name bindings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.7.9" data-path="../leiningen/todo-app/compojure/theory-using-hash-maps.html">
            
                <a href="../leiningen/todo-app/compojure/theory-using-hash-maps.html">
            
                  <!--  -->
                    Theory: using Clojure hash-maps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.7.10" data-path="../leiningen/todo-app/compojure/lisp-calculator.html">
            
                <a href="../leiningen/todo-app/compojure/lisp-calculator.html">
            
                  <!--  -->
                    Lisp Calculator
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.8" data-path="../leiningen/todo-app/heroku/">
            
                <a href="../leiningen/todo-app/heroku/">
            
                  <!--  -->
                    Deploying to Heroku
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.8.1" data-path="../leiningen/todo-app/heroku/update-project.html">
            
                <a href="../leiningen/todo-app/heroku/update-project.html">
            
                  <!--  -->
                    Update the project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.8.2" data-path="../leiningen/todo-app/heroku/procfile.html">
            
                <a href="../leiningen/todo-app/heroku/procfile.html">
            
                  <!--  -->
                    Add Procfile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.8.3" data-path="../leiningen/todo-app/heroku/deploy.html">
            
                <a href="../leiningen/todo-app/heroku/deploy.html">
            
                  <!--  -->
                    Deploy to Heroku
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.9" data-path="../leiningen/todo-app/hiccup/">
            
                <a href="../leiningen/todo-app/hiccup/">
            
                  <!--  -->
                    Hiccup HTML library
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.9.1" data-path="../leiningen/todo-app/hiccup/updating-handlers-with-hiccup.html">
            
                <a href="../leiningen/todo-app/hiccup/updating-handlers-with-hiccup.html">
            
                  <!--  -->
                    Updating handlers with hiccup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.9.2" data-path="../leiningen/todo-app/hiccup/create-new-handler.html">
            
                <a href="../leiningen/todo-app/hiccup/create-new-handler.html">
            
                  <!--  -->
                    Create a new handler
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.10" data-path="../leiningen/todo-app/refactor-namespace/">
            
                <a href="../leiningen/todo-app/refactor-namespace/">
            
                  <!--  -->
                    Refactor namespace
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.10.1" data-path="../leiningen/todo-app/refactor-namespace/base-routes.html">
            
                <a href="../leiningen/todo-app/refactor-namespace/base-routes.html">
            
                  <!--  -->
                    Base routes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.10.2" data-path="../leiningen/todo-app/refactor-namespace/core.html">
            
                <a href="../leiningen/todo-app/refactor-namespace/core.html">
            
                  <!--  -->
                    Refactored Core
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.11" data-path="../leiningen/todo-app/postgres/">
            
                <a href="../leiningen/todo-app/postgres/">
            
                  <!--  -->
                    Postgres Database
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.11.1" data-path="../leiningen/todo-app/postgres/install.html">
            
                <a href="../leiningen/todo-app/postgres/install.html">
            
                  <!--  -->
                    Postgres install
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.11.2" data-path="../leiningen/todo-app/postgres/environment-variables.html">
            
                <a href="../leiningen/todo-app/postgres/environment-variables.html">
            
                  <!--  -->
                    Environment Variables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.11.3" data-path="../leiningen/todo-app/postgres/postgres-cli.html">
            
                <a href="../leiningen/todo-app/postgres/postgres-cli.html">
            
                  <!--  -->
                    Postgres CLI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.11.4" data-path="../leiningen/todo-app/postgres/dataclips.html">
            
                <a href="../leiningen/todo-app/postgres/dataclips.html">
            
                  <!--  -->
                    Dataclips
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.11.5" data-path="../leiningen/todo-app/connect-to-postgres/">
            
                <a href="../leiningen/todo-app/connect-to-postgres/">
            
                  <!--  -->
                    Connect to Postgres
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.11.5.1" data-path="../leiningen/todo-app/connect-to-postgres/add-database-dependencies.html">
            
                <a href="../leiningen/todo-app/connect-to-postgres/add-database-dependencies.html">
            
                  <!--  -->
                    Add Database Dependencies
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.11.5.2" data-path="../leiningen/todo-app/connect-to-postgres/define-db-connection.html">
            
                <a href="../leiningen/todo-app/connect-to-postgres/define-db-connection.html">
            
                  <!--  -->
                    Define Database Connection
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.11.6" data-path="../leiningen/todo-app/database-model/">
            
                <a href="../leiningen/todo-app/database-model/">
            
                  <!--  -->
                    Creating a database model
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.11.6.1" data-path="../leiningen/todo-app/database-model/create-table.html">
            
                <a href="../leiningen/todo-app/database-model/create-table.html">
            
                  <!--  -->
                    Create table
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.11.6.2" data-path="../leiningen/todo-app/database-model/create-task.html">
            
                <a href="../leiningen/todo-app/database-model/create-task.html">
            
                  <!--  -->
                    Create task
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.11.6.3" data-path="../leiningen/todo-app/database-model/show-all-task.html">
            
                <a href="../leiningen/todo-app/database-model/show-all-task.html">
            
                  <!--  -->
                    List tasks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.11.6.4" data-path="../leiningen/todo-app/database-model/delete-task.html">
            
                <a href="../leiningen/todo-app/database-model/delete-task.html">
            
                  <!--  -->
                    Delete task
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.11.6.5" data-path="../leiningen/todo-app/database-model/alternative-approaches.html">
            
                <a href="../leiningen/todo-app/database-model/alternative-approaches.html">
            
                  <!--  -->
                    Alternative approaches
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.1.11.7" data-path="../leiningen/todo-app/task-handlers/">
            
                <a href="../leiningen/todo-app/task-handlers/">
            
                  <!--  -->
                    Task handlers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.11.7.1" data-path="../leiningen/todo-app/task-handlers/add-a-task.html">
            
                <a href="../leiningen/todo-app/task-handlers/add-a-task.html">
            
                  <!--  -->
                    Add a task
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.11.7.2" data-path="../leiningen/todo-app/task-handlers/show-task.html">
            
                <a href="../leiningen/todo-app/task-handlers/show-task.html">
            
                  <!--  -->
                    Show tasks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.11.7.3" data-path="../leiningen/todo-app/task-handlers/delete-a-task.html">
            
                <a href="../leiningen/todo-app/task-handlers/delete-a-task.html">
            
                  <!--  -->
                    Delete a task
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Building API's</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="../../server-side-api/">
            
                <a href="../../server-side-api/">
            
                  <!--  -->
                    Server-side API
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1.1" data-path="../../server-side-api/compojure-api-template.html">
            
                <a href="../../server-side-api/compojure-api-template.html">
            
                  <!--  -->
                    Compojure-API template
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.2" data-path="../../server-side-api/create-compojure-api-project.html">
            
                <a href="../../server-side-api/create-compojure-api-project.html">
            
                  <!--  -->
                    Create API project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.3" data-path="../../server-side-api/swagger.html">
            
                <a href="../../server-side-api/swagger.html">
            
                  <!--  -->
                    Swagger
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1.3.1" data-path="../../server-side-api/ring-swagger.html">
            
                <a href="../../server-side-api/ring-swagger.html">
            
                  <!--  -->
                    ring-swagger
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8.1.4" data-path="../../server-side-api/plumatic-schema.html">
            
                <a href="../../server-side-api/plumatic-schema.html">
            
                  <!--  -->
                    Plumatic Schema
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.5" data-path="../../server-side-api/json-files.html">
            
                <a href="../../server-side-api/json-files.html">
            
                  <!--  -->
                    JSON files
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.6" data-path="../../server-side-api/testing-api.html">
            
                <a href="../../server-side-api/testing-api.html">
            
                  <!--  -->
                    Testing an API
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1.6.1" data-path="../../server-side-api/ring-mock.html">
            
                <a href="../../server-side-api/ring-mock.html">
            
                  <!--  -->
                    ring-mock library
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.6.2" data-path="../../server-side-api/cheshire.html">
            
                <a href="../../server-side-api/cheshire.html">
            
                  <!--  -->
                    cheshire library
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8.1.7" data-path="../../server-side-api/end-to-end-testing/">
            
                <a href="../../server-side-api/end-to-end-testing/">
            
                  <!--  -->
                    End to End Testing
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1.7.1" data-path="../../server-side-api/end-to-end-testing/swagger.html">
            
                <a href="../../server-side-api/end-to-end-testing/swagger.html">
            
                  <!--  -->
                    Swagger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.7.2" data-path="../../server-side-api/end-to-end-testing/curl.html">
            
                <a href="../../server-side-api/end-to-end-testing/curl.html">
            
                  <!--  -->
                    Curl
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.7.3" data-path="../../server-side-api/end-to-end-testing/insomnia.md">
            
                <span>
            
                  <!--  -->
                    Insomnia
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="8.1.7.4" data-path="../../server-side-api/end-to-end-testing/postman.html">
            
                <a href="../../server-side-api/end-to-end-testing/postman.html">
            
                  <!--  -->
                    Postman Client
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8.1.8" data-path="../../server-side-api/terminology.html">
            
                <a href="../../server-side-api/terminology.html">
            
                  <!--  -->
                    Terminology
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Reference</li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="../../reference/ring/">
            
                <a href="../../reference/ring/">
            
                  <!--  -->
                    Ring
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1.1" data-path="../../reference/ring/request-map.html">
            
                <a href="../../reference/ring/request-map.html">
            
                  <!--  -->
                    Request map
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Hacking on content</li>
        
        
    
        <li class="chapter " data-level="10.1" data-path="../../project-url-shortner/">
            
                <a href="../../project-url-shortner/">
            
                  <!--  -->
                    Project: URL Shortner as a Service
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="10.1.1" data-path="../../project-url-shortner/create-project.html">
            
                <a href="../../project-url-shortner/create-project.html">
            
                  <!--  -->
                    Create project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.1.2" data-path="../../project-url-shortner/run-project.html">
            
                <a href="../../project-url-shortner/run-project.html">
            
                  <!--  -->
                    Run project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.1.3" data-path="../../project-url-shortner/test-app-reloading.html">
            
                <a href="../../project-url-shortner/test-app-reloading.html">
            
                  <!--  -->
                    Test app reloading
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.1.4" data-path="../../project-url-shortner/compojure-template.html">
            
                <a href="../../project-url-shortner/compojure-template.html">
            
                  <!--  -->
                    Compojure Template
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.1.5" data-path="../../project-url-shortner/design-data-structure.html">
            
                <a href="../../project-url-shortner/design-data-structure.html">
            
                  <!--  -->
                    Design data structure
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.1.6" data-path="../../project-url-shortner/whats-in-a-request.html">
            
                <a href="../../project-url-shortner/whats-in-a-request.html">
            
                  <!--  -->
                    Whats in a request
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.1.7" data-path="../../project-url-shortner/redirect-to-full-url.html">
            
                <a href="../../project-url-shortner/redirect-to-full-url.html">
            
                  <!--  -->
                    Redirect to full URL
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="" target="_blank" class="gitbook-link">
            Author: Practicalli
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Defining handlers</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="refactor-handlers-and-unit-tests">Refactor handlers and unit tests</h2>
<p>Refactor the unit tests to use the ring-mock library to test handler functions.  Create separate handler functions for the routes in <code>defroute</code> (there is only one custom handler at present).</p>
<pre class="language-"><code class="lang-clojure"><span class="token punctuation">(</span><span class="token function">deftest</span> dashboard-test
  <span class="token punctuation">(</span><span class="token function">testing</span> <span class="token string">&quot;Testing elements on the dashboard&quot;</span>
    <span class="token punctuation">(</span><span class="token function">is</span> <span class="token punctuation">(</span><span class="token keyword">=</span> <span class="token punctuation">(</span><span class="token function">SUT/dashboard</span> <span class="token punctuation">(</span><span class="token function">mock/request</span> <span class="token symbol">:get</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
           <span class="token punctuation">{</span><span class="token symbol">:status</span>  <span class="token number">200</span>
            <span class="token symbol">:body</span>    <span class="token string">&quot;Status Monitor Dashboard&quot;</span>
            <span class="token symbol">:headers</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>Create a handler for the <code>GET &quot;/&quot;</code> route</p>
<pre class="language-"><code class="lang-clojure"><span class="token punctuation">(</span><span class="token keyword">defn</span> dashboard
  <span class="token punctuation">[</span>request<span class="token punctuation">]</span>
  <span class="token punctuation">{</span><span class="token symbol">:status</span> <span class="token punctuation">(</span><span class="token symbol">:OK</span> http-status-code<span class="token punctuation">)</span> <span class="token symbol">:body</span> <span class="token string">&quot;Status Monitor Dashboard&quot;</span> <span class="token symbol">:headers</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre>
<p>Use the <code>ring.util.response/response</code> function to create a well formed response map which has a status code of 200.  This removes the need to type in the response map structure explicitly which potentially can introduce bugs.</p>
<p>In the current namespace <code>ns</code> form, this function is required as an explicit refer, <code>[ring.util.response :refer [response]]</code>, so its available to use by its unqualified name, <code>response</code>.</p>
<pre class="language-"><code class="lang-clojure"><span class="token punctuation">(</span><span class="token keyword">defn</span> dashboard
  <span class="token punctuation">[</span>request<span class="token punctuation">]</span>
  <span class="token punctuation">(</span><span class="token function">response</span> <span class="token string">&quot;Status Monitor Dashboard&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>Update the <code>defroutes</code> definition to call this handler rather than hard coding the response map.</p>
<pre class="language-"><code class="lang-clojure"><span class="token punctuation">(</span><span class="token function">defroutes</span> status-monitor
  <span class="token punctuation">(</span><span class="token function">GET</span> <span class="token string">&quot;/&quot;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> dashboard<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">GET</span> <span class="token string">&quot;/request-dump&quot;</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> handle-dump<span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
</code></pre>
<p>Run the Cognitect test runner to check the unit tests are still passing after the code refactor.</p>
<pre class="language-"><code class="lang-clojure">clojure -A:dev:test:runner
</code></pre>
<h2 id="reference-additional-helper-functions">Reference: Additional helper functions</h2>
<p>The ring util library contains several other helper functions, <code>bad-request</code>, <code>not-found</code> and <code>redirect</code>:</p>
<pre class="language-"><code class="lang-clojure"><span class="token punctuation">(</span><span class="token function">ring.util.response/bad-request</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span>
<span class="token comment">;;=&gt; {:status 400, :headers {}, :body &quot;Hello&quot;}</span>

<span class="token punctuation">(</span><span class="token function">ring.util.response/created</span> <span class="token string">&quot;/post/clojure-is-awesome&quot;</span><span class="token punctuation">)</span>
<span class="token comment">;;=&gt; {:status 201, :headers {&quot;Location&quot; &quot;/post/clojure-is-awesome&quot;}, :body nil}</span>

<span class="token punctuation">(</span><span class="token function">ring.util.response/redirect</span> <span class="token string">&quot;https://clojure.org/getting-started/&quot;</span><span class="token punctuation">)</span>
<span class="token comment">;;=&gt; {:status 302, :headers {&quot;Location&quot; &quot;https://clojure.org/getting-started/&quot;}, :body &quot;&quot;}</span>
</code></pre>
<p>The <code>status</code> function converts an existing response to use a given status code (which can be anything).  Use this with care and document what the status code means otherwise confusion will abound.</p>
<pre class="language-"><code class="lang-clojure"><span class="token punctuation">(</span><span class="token function">ring.util.response/status</span> <span class="token punctuation">(</span><span class="token function">ring.util.response/response</span> <span class="token string">&quot;Time for Cake!&quot;</span><span class="token punctuation">)</span> <span class="token number">555</span><span class="token punctuation">)</span>
<span class="token comment">;;=&gt; {:status 555, :headers {}, :body &quot;Time for Cake!&quot;}</span>
</code></pre>
<p>Ring utilities has functions for setting the header data for responses, <code>content-type</code>, <code>header</code> or <code>set-cookie</code>.</p>
<pre class="language-"><code class="lang-clojure"><span class="token punctuation">(</span><span class="token function">ring.util.response/content-type</span> <span class="token punctuation">(</span><span class="token function">ring.util.response/response</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span> <span class="token string">&quot;text/plain&quot;</span><span class="token punctuation">)</span>
<span class="token comment">;;=&gt;  {:status 200, :headers {&quot;Content-Type&quot; &quot;text/plain&quot;}, :body &quot;Hello&quot;}</span>

<span class="token punctuation">(</span><span class="token function">ring.util.response/header</span> <span class="token punctuation">(</span><span class="token function">ring.util.response/response</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span> <span class="token string">&quot;X-Tutorial-For&quot;</span> <span class="token string">&quot;Practicalli&quot;</span><span class="token punctuation">)</span>
<span class="token comment">;;=&gt;  {:status 200, :headers {&quot;X-Tutorial-For&quot; &quot;Practicalli&quot;}, :body &quot;Hello&quot;}</span>

<span class="token punctuation">(</span><span class="token function">ring.util.response/set-cookie</span> <span class="token punctuation">(</span><span class="token function">ring.util.response/response</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span> <span class="token string">&quot;User&quot;</span> <span class="token string">&quot;123&quot;</span><span class="token punctuation">)</span>
<span class="token comment">;;=&gt;  {:status 200, :headers {}, :body &quot;Hello&quot;, :cookies {&quot;User&quot; {:value &quot;123&quot;}}}</span>
</code></pre>
<div class="panel panel-success"><div class="panel-heading"><h3 class="panel-title" id="wrap-cookies-middleware-required"><i class="fa fa-lightbulb-o"></i> wrap-cookies middleware required</h3></div><div class="panel-body"><p>The <code>set-cookie</code> function adds a new entry to the response map and requires the <code>wrap-cookies</code> middleware to process correctly.</p></div></div>
<h2 id="reference-handler-functions">Reference: handler functions</h2>
<p>A handler to return the incoming IP Address</p>
<pre class="language-"><code class="lang-clojure"><span class="token punctuation">(</span><span class="token keyword">defn</span> check-ip-handler <span class="token punctuation">[</span>request<span class="token punctuation">]</span>
    <span class="token punctuation">(</span><span class="token function">ring.util.response/content-type</span>
        <span class="token punctuation">(</span><span class="token function">ring.util.response/response</span> <span class="token punctuation">(</span><span class="token symbol">:remote-addr</span> request<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token string">&quot;text/plain&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<!-- ## Reference: middleware -->
<!-- Middleware is a name that's common in some languages but less so in the Java world. Conceptually they are similar to Servlet Filters and Spring Interceptors. -->
<!-- In Ring, middleware refers to simple functions that wrap the main handler and adjusts some aspects of it in some way. This could mean mutating the incoming request before it's processed, mutating the outgoing response after it's generated or potentially doing nothing more than logging how long it took to process. -->
<!-- In general, middleware functions take a first parameter of the handler to wrap and returns a new handler function with the new functionality. -->
<!-- The middleware can use as many other parameters as needed. For example, we could use the following to set the Content-Type header on every response from the wrapped handler: -->
<!-- (defn wrap-content-type [handler content-type] -->
<!--   (fn [request] -->
<!--     (let [response (handler request)] -->
<!--       (assoc-in response [:headers "Content-Type"] content-type)))) -->
<!-- Reading through it we can see that we return a function that takes a request â this's the new handler. This will then call the provided handler and then return a mutated version of the response. -->
<!-- We can use this to produce a new handler by simply chaining them together: -->
<!-- (def app-handler (wrap-content-type handler "text/html")) -->
<!-- Clojure also offers a way to chain many together in a more natural way â by the use of Threading Macros. These are a way to provide a list of functions to call, each with the output of the previous one. -->
<!-- In particular, we want the Thread First macro, ->. This will allow us to call each middleware with the provided value as the first parameter: -->
<!-- (def app-handler -->
<!--   (-> handler -->
<!--       (wrap-content-type "text/html") -->
<!--       wrap-keyword-params -->
<!--       wrap-params)) -->
<!-- This has then produced a handler that's the original handler wrapped in three different middleware functions. -->
<!-- ## Serving Static Resources -->
<!-- One of the simplest functions that any web application can perform is to serve up static resources. Ring provides two middleware functions to make this easy â wrap-file and wrap-resource. -->
<!-- The wrap-file middleware takes a directory on the filesystem. If the incoming request matches a file in this directory then that file gets returned instead of calling the handler function: -->
<!-- (use 'ring.middleware.file) -->
<!-- (def app-handler (wrap-file your-handler "/var/www/public")) -->
<!-- In a very similar manner, the wrap-resource middleware takes a classpath prefix in which it looks for the files: -->
<!-- (use 'ring.middleware.resource) -->
<!-- (def app-handler (wrap-resource your-handler "public")) -->
<!-- In both cases, the wrapped handler function is only ever called if a file isn't found to return to the client. -->
<!-- Ring also provides additional middleware to make these cleaner to use over the HTTP API: -->
<!-- (use 'ring.middleware.resource -->
<!--      'ring.middleware.content-type -->
<!--      'ring.middleware.not-modified) -->
<!-- (def app-handler -->
<!--   (-> your-handler -->
<!--       (wrap-resource "public") -->
<!--       wrap-content-type -->
<!--       wrap-not-modified) -->
<!-- The wrap-content-type middleware will automatically determine the Content-Type header to set based on the filename extension requested. The wrap-not-modified middleware compares the If-Not-Modified header to the Last-Modified value to support HTTP caching, only returning the file if it's needed. -->
<!-- 4.2. Accessing Request Parameters -->
<!-- When processing a request, there are some important ways that the client can provide information to the server. These include query string parameters â included in the URL and form parameters â submitted as the request payload for POST and PUT requests. -->
<!-- Before we can use parameters, we must use the wrap-params middleware to wrap the handler. This correctly parses the parameters, supporting URL encoding, and makes them available to the request. This can optionally specify the character encoding to use, defaulting to UTF-8 if not specified: -->
<!-- (def app-handler -->
<!--   (-> your-handler -->
<!--       (wrap-params {:encoding "UTF-8"}) -->
<!--   )) -->
<!-- Once done, the request will get updated to make the parameters available. These go into appropriate keys in the incoming request: -->
<!--     :query-params â The parameters parsed out of the query string -->
<!--     :form-params â The parameters parsed out of the form body -->
<!--     :params â The combination of both :query-params and :form-params -->
<!-- We can make use of this in our request handler exactly as expected. -->
<!-- (defn echo-handler [{params :params}] -->
<!--     (ring.util.response/content-type -->
<!--         (ring.util.response/response (get params "input")) -->
<!--         "text/plain")) -->
<!-- This handler will return a response containing the value from the parameter input. -->
<!-- Parameters map to a single string if only one value is present, or to a list if multiple values are present. -->
<!-- For example, we get the following parameter maps: -->
<!-- // /echo?input=hello -->
<!-- {"input "hello"} -->
<!-- // /echo?input=hello&name=Fred -->
<!-- {"input "hello" "name" "Fred"} -->
<!-- // /echo?input=hello&input=world -->
<!-- {"input ["hello" "world"]} -->
<!-- ## File Uploads -->
<!-- Often we want to be able to write web applications that users can upload files to. In the HTTP protocol, this is typically handled using Multipart requests. These allow for a single request to contain both form parameters and a set of files. -->
<!-- Ring comes with a middleware called wrap-multipart-params to handle this kind of request. This is similar to the way that wrap-params parses simple requests. -->
<!-- wrap-multipart-params automatically decodes and stores any uploaded files onto the file system and tells the handler where they are for it to work with them: -->
<!-- (def app-handler -->
<!--   (-> your-handler -->
<!--       wrap-params -->
<!--       wrap-multipart-params -->
<!--   )) -->
<!-- By default, the uploaded files get stored in the temporary system directory and automatically deleted after an hour. Note that this does require that the JVM is still running for the next hour to perform the cleanup. -->
<!-- If preferred, there's also an in-memory store, though obviously, this risks running out of memory if large files get uploaded. -->
<!-- We can also write our storage engines if needed, as long as it fulfills the API requirements. -->
<!-- (def app-handler -->
<!--   (-> your-handler -->
<!--       wrap-params -->
<!--       (wrap-multipart-params {:store ring.middleware.multipart-params.byte-array/byte-array-store}) -->
<!--   )) -->
<!-- Once this middleware is set up, the uploaded files are available on the incoming request object under the params key. This is the same as using the wrap-params middleware. This entry is a map containing the details needed to work with the file, depending on the store used. -->
<!-- For example, the default temporary file store returns values: -->
<!--   {"file" {:filename     "words.txt" -->
<!--            :content-type "text/plain" -->
<!--            :tempfile     #object[java.io.File ...] -->
<!--            :size         51}} -->
<!-- Where the :tempfile entry is a java.io.File object that directly represents the file on the file system. -->
<!-- ## Working With Cookies -->
<!-- Cookies are a mechanism where the server can provide a small amount of data that the client will continue to send back on subsequent requests. This is typically used for session IDs, access tokens, or persistent user data such as the configured localization settings. -->
<!-- Ring has middleware that will allow us to work with cookies easily. This will automatically parse cookies on incoming requests, and will also allow us to create new cookies on outgoing responses. -->
<!-- Configuring this middleware follows the same patterns as before: -->
<!-- (def app-handler -->
<!--   (-> your-handler -->
<!--       wrap-cookies -->
<!--   )) -->
<!-- At this point, all incoming requests will have their cookies parsed and put into the :cookies key in the request. This will contain a map of the cookie name and value: -->
<!-- {"session_id" {:value "session-id-hash"}} -->
<!-- We can then add cookies to outgoing responses by adding the :cookies key to the outgoing response. We can do this by creating the response directly: -->
<!-- {:status 200 -->
<!--  :headers {} -->
<!--  :cookies {"session_id" {:value "session-id-hash"}} -->
<!--  :body "Setting a cookie."} -->
<!-- There's also a helper function that we can use to add cookies to responses, in a similar way to how earlier we could set status codes or headers: -->
<!-- (ring.util.response/set-cookie -->
<!--     (ring.util.response/response "Setting a cookie.") -->
<!--     "session_id" -->
<!--     "session-id-hash") -->
<!-- Cookies can also have additional options set on them, as needed for the HTTP specification. If we're using set-cookie then we provide these as a map parameter after the key and value. The keys to this map are: -->
<!--     :domain â The domain to restrict the cookie to -->
<!--     :path â The path to restrict the cookie to -->
<!--     :secure â true to only send the cookie on HTTPS connections -->
<!--     :http-only â true to make the cookie inaccessible to JavaScript -->
<!--     :max-age â The number of seconds after which the browser deletes the cookie -->
<!--     :expires â A specific timestamp after which the browser deletes the cookie -->
<!--     :same-site â If set to :strict, then the browser won't send this cookie back with cross-site requests. -->
<!-- (ring.util.response/set-cookie -->
<!--     (ring.util.response/response "Setting a cookie.") -->
<!--     "session_id" -->
<!--     "session-id-hash" -->
<!--     {:secure true :http-only true :max-age 3600}) -->
<!-- ## Sessions -->
<!-- Cookies give us the ability to store bits of information that the client sends back to the server on every request. A more powerful way of achieving this is to use sessions. These get stored entirely on the server, but the client maintains the identifier that determines which session to use. -->
<!-- As with everything else here, sessions are implemented using a middleware function: -->
<!-- (def app-handler -->
<!--   (-> your-handler -->
<!--       wrap-session -->
<!--   )) -->
<!-- By default, this stores session data in memory. We can change this if needed, and Ring comes with an alternative store that uses cookies to store all of the session data. -->
<!-- As with uploading files, we can provide our storage function if needed. -->
<!-- (def app-handler -->
<!--   (-> your-handler -->
<!--       wrap-cookies -->
<!--       (wrap-session {:store (cookie-store {:key "a 16-byte secret"})}) -->
<!--   )) -->
<!-- We can also adjust the details of the cookie used to store the session key. -->
<!-- For example, to make it so that the session cookie persists for one hour we could do: -->
<!-- (def app-handler -->
<!--   (-> your-handler -->
<!--       wrap-cookies -->
<!--       (wrap-session {:cookie-attrs {:max-age 3600}}) -->
<!--   )) -->
<!-- The cookie attributes here are the same as supported by the wrap-cookies middleware. -->
<!-- Sessions can often act as data stores to work with. This doesn't always work as well in a functional programming model, so Ring implements them slightly differently. -->
<!-- Instead, we access the session data from the request, and we return a map of data to store into it as part of the response. This is the entire session state to store, not only the changed values. -->
<!-- For example, the following keeps a running count of how many times the handler has been requested: -->
<!-- (defn handler [{session :session}] -->
<!--   (let [count   (:count session 0) -->
<!--         session (assoc session :count (inc count))] -->
<!--     (-> (response (str "You accessed this page " count " times.")) -->
<!--         (assoc :session session)))) -->
<!-- Working this way, we can remove data from the session simply by not including the key. We can also delete the entire session by returning nil for the new map. -->
<!-- (defn handler [request] -->
<!--   (-> (response "Session deleted.") -->
<!--       (assoc :session nil))) -->
 <link rel="stylesheet" type="text/css" href="https://storage.googleapis.com/app.klipse.tech/css/codemirror.css"> <script>     window.klipse_settings = {         selector: ".language-klipse, .lang-eval-clojure",         selector_eval_js: ".lang-eval-js",         selector_eval_python_client: ".lang-eval-python",         selector_eval_php: ".lang-eval-php",         selector_eval_scheme: ".lang-eval-scheme",         selector_eval_ruby: ".lang-eval-ruby",         selector_reagent: ".lang-reagent",        selector_google_charts: ".lang-google-chart",        selector_es2017: ".lang-eval-es2017",        selector_jsx: ".lang-eval-jsx",        selector_transpile_jsx: ".lang-transpile-jsx",        selector_render_jsx: ".lang-render-jsx",        selector_react: ".lang-react",        selector_eval_markdown: ".lang-render-markdown",        selector_eval_lambdaway: ".lang-render-lambdaway",        selector_eval_cpp: ".lang-eval-cpp",        selector_eval_html: ".lang-render-html",        selector_sql: ".lang-eval-sql",        selector_brainfuck: "lang-eval-brainfuck",        selector_js: ".lang-transpile-cljs"    }; </script> <script src="https://storage.googleapis.com/app.klipse.tech/plugin/js/klipse_plugin.js"></script>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="unit-test-mocking-handlers.html" class="navigation navigation-prev " aria-label="Previous page: Unit Test & Mocking">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="continuous-integration.html" class="navigation navigation-next " aria-label="Next page: Continuous integration">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Defining handlers","level":"2.1.4","depth":2,"next":{"title":"Continuous integration","level":"2.1.5","depth":2,"path":"projects/status-monitor-deps/continuous-integration.md","ref":"projects/status-monitor-deps/continuous-integration.md","articles":[]},"previous":{"title":"Unit Test & Mocking","level":"2.1.3","depth":2,"path":"projects/status-monitor-deps/unit-test-mocking-handlers.md","ref":"projects/status-monitor-deps/unit-test-mocking-handlers.md","articles":[]},"dir":"ltr"},"config":{"plugins":["anchor-headings-lambda","callouts","codeblock-disable-glossary","folding-chapters","ga","-glossary","-highlight","klipse","newtabs","prism","sectionx","simpletabs","-sharing","splitter","terminull-light","theme-jr0cket","toggle-chapters","toolbar","youtube","wide-page"],"styles":{"website":"styles/website.css","ebook":"styles/ebook.css","pdf":"styles/pdf.css","mobi":"styles/mobi.css","epub":"styles/epub.css"},"pluginsConfig":{"prism":{"ignore":["eval-clojure"]},"callouts":{"showTypeInHeader":false,"star":{"alert":"warning","picto":"fa-star"}},"youtube":{},"splitter":{},"search":{},"wide-page":{},"anchor-headings-lambda":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"terminull-light":{},"simpletabs":{},"codeblock-disable-glossary":{},"fontsettings":{"theme":"white","family":"sans","size":2},"folding-chapters":{},"sectionx":{"tag":"b"},"ga":{"configuration":"auto","token":"UA-28030709-8"},"klipse":{"myConfigKey":"it's the default value"},"theme-jr0cket":{"showLevel":false,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"toolbar":{"buttons":[{"label":"Clojurians Slack","icon":"fa fa-comments-o","url":"http://clojurians.slack.com/messages/practicalli"},{"label":"GitHub","icon":"fa fa-github","url":"https://github.com/practicalli/clojure-webapps-content/issues"}]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"newtabs":{},"toggle-chapters":{}},"theme":"default","author":"Practicalli","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"P9IDeveloperGuides":"https://github.com/jr0cket/developer-guides/raw/master/","P9IPullRequestsUrl":"https://github.com/practicalli/clojure-webapps-content/pulls","P9IClojureDepsEdn":"https://github.com/practicalli/clojure-deps-edn","KeyDownArrow":"<kbd>â</kbd>","host":"practical.li","KeyCtrl":"<kbd>Ctrl</kbd>","Leiningen":"https://leiningen.org/","P9IClojureThroughCode":"https://github.com/practicalli/clojure-through-code","KeyUpArrow":"<kbd>â</kbd>","P9IIssuesUrl":"https://github.com/practicalli/clojure-webapps-content/issues","KeyEsc":"<kbd>Esc</kbd>","KeyEnter":"<kbd>Enter</kbd>","website":"https://practical.github.io/clojure","P9IFourClojure":"https://practical.github.io/clojure"},"title":"Practicalli Clojure WebApps","links":{"sidebar":{"Practical.li":"https://practicalli.github.io"}},"gitbook":">=3.2.3","description":"Server-side applications and APIs in Clojure"},"file":{"path":"projects/status-monitor-deps/refactor-handlers-and-tests.md","mtime":"2022-03-28T13:09:25.221Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2022-03-28T13:10:33.694Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>


        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-anchor-headings-lambda/anchor-style.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-codeblock-disable-glossary/disable-glossary.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-folding-chapters/folding-chapters.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-newtabs/bootstrap.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-newtabs/tabs.js"></script>
        
    
        
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sectionx/sectionx.js"></script>
        
    
        
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-simpletabs/tabs.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-terminull-light/terminull.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-toggle-chapters/toggle.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-toolbar/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

        
    </body>
</html>

